<!--
  ~ Copyright (c) 2017. The Hyve and respective contributors
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~
  ~ See the file LICENSE in the root of this repository.
  ~
  -->

<div>
    <h2>
        <span id="metrics-page-heading" data-cy="metricsPageHeading">Application Metrics</span>

        <button class="btn btn-primary float-right" (click)="refresh()"><fa-icon icon="sync"></fa-icon> <span>Refresh</span></button>
    </h2>

    <h3>JVM Metrics</h3>

    <div class="row" *ngIf="metrics && !updatingMetrics">
        <pdm-jvm-memory class="col-md-4" [updating]="updatingMetrics" [jvmMemoryMetrics]="metrics.jvm"></pdm-jvm-memory>

        <pdm-jvm-threads class="col-md-4" [threads]="threads"></pdm-jvm-threads>

        <pdm-metrics-system class="col-md-4" [updating]="updatingMetrics" [systemMetrics]="metrics.processMetrics"></pdm-metrics-system>
    </div>

    <pdm-metrics-garbagecollector
        *ngIf="metrics && metricsKeyExists('garbageCollector')"
        [updating]="updatingMetrics"
        [garbageCollectorMetrics]="metrics.garbageCollector"
    ></pdm-metrics-garbagecollector>

    <div class="well well-lg" *ngIf="updatingMetrics">Updating...</div>

    <pdm-metrics-request
        *ngIf="metrics && metricsKeyExists('http.server.requests')"
        [updating]="updatingMetrics"
        [requestMetrics]="metrics['http.server.requests']"
    ></pdm-metrics-request>

    <pdm-metrics-endpoints-requests
        *ngIf="metrics && metricsKeyExists('services')"
        [updating]="updatingMetrics"
        [endpointsRequestsMetrics]="metrics.services"
    ></pdm-metrics-endpoints-requests>

    <pdm-metrics-cache
        *ngIf="metrics && metricsKeyExists('cache')"
        [updating]="updatingMetrics"
        [cacheMetrics]="metrics.cache"
    ></pdm-metrics-cache>

    <pdm-metrics-datasource
        *ngIf="metrics && metricsKeyExistsAndObjectNotEmpty('databases')"
        [updating]="updatingMetrics"
        [datasourceMetrics]="metrics.databases"
    ></pdm-metrics-datasource>
</div>
