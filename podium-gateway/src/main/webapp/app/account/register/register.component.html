<!--
  ~ Copyright (c) 2017. The Hyve and respective contributors
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~
  ~ See the file LICENSE in the root of this repository.
  ~
  -->

<div class="content-wrapper">
    <div class="row">
        <div class="col-md-8 offset-md-2">
            <h1 [translate]="'register.title'"></h1>

            <div class="alert alert-success"
                *ngIf="success"
                [innerHTML]="'register.messages.success' | translate">
            </div>

            <div class="alert alert-danger"
                *ngIf="error"
                [innerHTML]="'register.messages.error.fail' | translate">
            </div>

            <div class="alert alert-danger"
                *ngIf="errorUserExists"
                [innerHTML]="'register.messages.error.userexists' | translate">
            </div>

            <div class="alert alert-danger" *ngIf="doNotMatch">The password and its confirmation do not match!</div>
        </div>
        <div class="col-md-8 offset-md-2">
            <form name="form" role="form"
                (ngSubmit)="register()"
                [formGroup]="registerForm"
                *ngIf="!success"
            >

                <!--Username-->
                <div class="form-group">
                    <label class="form-control-label" for="login"
                        [translate]="'global.form.username'">
                    </label>
                    <input type="text" class="form-control"
                        id="login" name="login"
                        placeholder="{{'global.form.username.placeholder' | translate}}"
                        formControlName="login"
                        #login
                        required minlength="1" maxlength="50"
                        pattern="^[_'.@A-Za-z0-9-]*$"
                    />

                    <div *ngIf="registerForm.get('login')!.invalid && (registerForm.get('login')!.dirty || registerForm.get('login')!.touched)">
                        <small class="form-text text-danger" *ngIf="registerForm.get('login')?.errors?.required"> Your username is required. </small>

                        <small class="form-text text-danger" *ngIf="registerForm.get('login')?.errors?.minlength">
                        Your username is required to be at least 1 character.
                        </small>

                        <small class="form-text text-danger" *ngIf="registerForm.get('login')?.errors?.maxlength">
                        Your username cannot be longer than 50 characters.
                        </small>

                        <small class="form-text text-danger" *ngIf="registerForm.get('login')?.errors?.pattern">
                        Your username can only contain letters and digits.
                        </small>
                    </div>
                </div>

                <!--First name-->
                <div class="form-group">
                    <label  class="form-control-label" for="firstName" >First name</label>
                    <input type="text" class="form-control"
                        id="firstName" name="firstName"
                        placeholder="{{'global.form.firstName.placeholder' | translate}}"
                        formControlName="firstName"
                    />
                    <div *ngIf="registerForm.get('firstName')!.invalid && (registerForm.get('firstName')!.dirty || registerForm.get('firstName')!.touched)">
                        <small class="form-text text-danger"
                            *ngIf="registerForm.get('firstName')?.errors?.required">
                            Your first name is required.
                        </small>
                        <small class="form-text text-danger"
                            *ngIf="registerForm.get('firstName')?.errors?.minlength">
                            Your first name is required to be at least 1 character.
                        </small>
                        <small class="form-text text-danger"
                            *ngIf="registerForm.get('firstName')?.errors?.maxlength">
                            Your first name cannot be longer than 50 characters.
                        </small>
                    </div>
                </div>

                <!--Last name-->
                <div class="form-group">
                    <label  class="form-control-label" for="lastName" >Last name</label>
                    <input
                        type="text"
                        class="form-control"
                        id="lastName" name="lastName"
                        placeholder="{{'global.form.lastName.placeholder' | translate}}"
                        formControlName="lastName"
                    />
                    <div *ngIf="registerForm.get('lastName')!.invalid && (registerForm.get('lastName')!.dirty || registerForm.get('lastName')!.touched)">
                        <small class="form-text text-danger"
                            *ngIf="registerForm.get('lastName')?.errors?.required">
                            Your last name is required.
                        </small>
                        <small class="form-text text-danger"
                            *ngIf="registerForm.get('lastName')?.errors?.minlength">
                            Your last name is required to be at least 1 character.
                        </small>
                        <small class="form-text text-danger"
                            *ngIf="registerForm.get('lastName')?.errors?.maxlength">
                            Your last name cannot be longer than 50 characters.
                        </small>
                    </div>
                </div>

                <!--E-mail-->
                <div class="form-group">
                    <label class="form-control-label" for="email">Email</label>
                    <input
                        type="email"
                        class="form-control"
                        id="email"
                        name="email"
                        placeholder="Your email"
                        formControlName="email"
                    />

                    <div *ngIf="registerForm.get('email')!.invalid && (registerForm.get('email')!.dirty || registerForm.get('email')!.touched)">
                        <small class="form-text text-danger"
                            *ngIf="registerForm.get('email')?.errors?.required"
                            [translate]="'global.messages.validate.email.required'">
                        </small>
                        <small class="form-text text-danger"
                            *ngIf="registerForm.get('email')?.errors?.email"
                            [translate]="'global.messages.validate.email.invalid'">
                        </small>
                        <small class="form-text text-danger"
                            *ngIf="registerForm.get('email')?.errors?.minlength"
                            [translate]="'global.messages.validate.email.minlength'">
                        </small>
                        <small class="form-text text-danger"
                            *ngIf="registerForm.get('email')?.errors?.maxlength"
                            [translate]="'global.messages.validate.email.maxlength'">
                        </small>
                    </div>
                </div>

                <!--Telephone number-->
                <div class="form-group">
                    <label class="form-control-label" for="telephone">
                        Telephone
                    </label>
                    <input
                        type="text"
                        class="form-control"
                        id="telephone"
                        name="telephone"
                        formControlName="telephone"
                        placeholder="{{'global.form.telephone.placeholder' | translate}}"
                    />
                    <div *ngIf="registerForm.get('telephone')!.invalid && (registerForm.get('telephone')!.dirty || registerForm.get('telephone')!.touched)">
                        <small class="form-text text-danger"
                            *ngIf="registerForm.get('telephone')?.errors?.required"
                        >
                            Your telephone number is required.
                        </small>
                        <small class="form-text text-danger"
                            *ngIf="registerForm.get('telephone')?.errors?.pattern"
                        >
                            Your telephone number must be numbers only.
                        </small>
                        <small class="form-text text-danger"
                            *ngIf="registerForm.get('telephone')?.errors?.maxlength"
                        >
                            Your telephone number cannot be longer than 15 characters.
                        </small>
                    </div>
                </div>

                <!--Institute-->
                <div class="form-group">
                    <label  class="form-control-label" for="institute" >Institute</label>
                    <input 
                        type="text"
                        class="form-control"
                        id="institute"
                        name="institute"
                        formControlName="institute"
                        placeholder="{{'global.form.institute.placeholder' | translate}}"
                    />
                    <div *ngIf="registerForm.get('institute')!.invalid && (registerForm.get('institute')!.dirty || registerForm.get('institute')!.touched)">
                        <small class="form-text text-danger"
                            *ngIf="registerForm.get('institute')?.errors?.required">
                            Your institute is required.
                        </small>
                        <small class="form-text text-danger"
                            *ngIf="registerForm.get('institute')?.errors?.minlength">
                            Your institute is required to be at least 1 character.
                        </small>
                        <small class="form-text text-danger"
                            *ngIf="registerForm.get('institute')?.errors?.maxlength">
                            Your institute cannot be longer than 150 characters.
                        </small>
                    </div>
                </div>

                <!--Department-->
                <div class="form-group">
                    <label  class="form-control-label" for="department" >Department</label>
                    <input 
                        type="text"
                        class="form-control"
                        id="department"
                        name="department"
                        formControlName="department"
                        placeholder="{{'global.form.department.placeholder' | translate}}"
                    />
                    <div *ngIf="registerForm.get('department')!.invalid && (registerForm.get('department')!.dirty || registerForm.get('department')!.touched)">
                        <small class="form-text text-danger"
                            *ngIf="registerForm.get('department')?.errors?.required">
                            Your department is required.
                        </small>
                        <small class="form-text text-danger"
                            *ngIf="registerForm.get('department')?.errors?.minlength">
                            Your department is required to be at least 1 character.
                        </small>
                        <small class="form-text text-danger"
                            *ngIf="registerForm.get('department')?.errors?.maxlength">
                            Your department cannot be longer than 150 characters.
                        </small>
                    </div>
                </div>


                <!--Function (Job Title)-->
                <div class="form-group">
                    <label  class="form-control-label" for="jobTitle" >Function</label>
                    <input 
                        type="text"
                        class="form-control"
                        id="jobTitle"
                        name="jobTitle"
                        formControlName="jobTitle"
                        placeholder="{{'global.form.jobTitle.placeholder' | translate}}"
                    />
                    <div *ngIf="registerForm.get('jobTitle')!.invalid && (registerForm.get('jobTitle')!.dirty || registerForm.get('jobTitle')!.touched)">
                        <small class="form-text text-danger"
                            *ngIf="registerForm.get('jobTitle')?.errors?.required">
                            Your job title is required.
                        </small>
                        <small class="form-text text-danger"
                            *ngIf="registerForm.get('jobTitle')?.errors?.minlength">
                            Your job title is required to be at least 1 character.
                        </small>
                        <small class="form-text text-danger"
                            *ngIf="registerForm.get('jobTitle')?.errors?.maxlength">
                            Your job title cannot be longer than 150 characters.
                        </small>
                    </div>
                </div>

                <!--Specialism-->
                <div class="form-group">
                    <label class="form-control-label" for="jobTitle">
                        Specialism
                    </label>
                    <pdm-specialism [(specialism)]="specialism"></pdm-specialism>
                </div>

                <br>
                <h3>Create Password</h3>

                <!--Password-->
                <div class="form-group">
                    <label class="form-control-label" for="password">New password</label>
                    <input type="password" class="form-control" id="password" name="password"
                        placeholder="{{'global.form.newpassword.placeholder' | translate}}"
                        formControlName="password"
                    />

                    <div
                        *ngIf="registerForm.get('password')!.invalid && (registerForm.get('password')!.dirty || registerForm.get('password')!.touched)"
                    >
                        <small class="form-text text-danger"
                            [translate]="'global.messages.validate.newpassword.required'">
                        </small>

                        <small class="form-text text-danger" *ngIf="registerForm.get('password')?.errors?.minlength">
                        Your password is required to be at least 4 characters.
                        </small>

                        <small class="form-text text-danger"
                            *ngIf="registerForm.get('password')?.errors?.maxlength"
                            [translate]="'global.messages.validate.newpassword.maxlength'">
                        </small>
                    </div>
                    <pdm-password-strength-bar [passwordToCheck]="registerForm.get('password')!.value"></pdm-password-strength-bar>
                </div>
                <div class="form-group">
                    <label class="form-control-label" for="confirmPassword"
                        [translate]="'global.form.confirmpassword'">
                    </label>
                    <input type="password" class="form-control" id="confirmPassword" name="confirmPassword"
                        placeholder="{{'global.form.confirmpassword.placeholder' | translate}}"
                        formControlName="confirmPassword"
                    />

                    <div
                        *ngIf="
                        registerForm.get('confirmPassword')!.invalid &&
                        (registerForm.get('confirmPassword')!.dirty || registerForm.get('confirmPassword')!.touched)
                        "
                    >
                        <small class="form-text text-danger" *ngIf="registerForm.get('confirmPassword')?.errors?.required"
                            [translate]="'global.messages.validate.confirmpassword.required'">
                        </small>
                    </div>
                </div>

                <button type="submit" [disabled]="registerForm.invalid"
                    class="btn btn-primary"
                    [translate]="'register.form.button'">
                </button>
            </form>
            <p></p>
        </div>
    </div>
</div>
